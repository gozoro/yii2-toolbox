(function(g){"undefined"==typeof g?console.warn("Required jQuery."):g.fn.autocompleter=function(u,e){e=g.extend({maxResults:0,minChars:1,timeout:500,matchRegexp:null,matchValue:function(h,l){return h},itemDisplay:function(h,l){return h},itemValue:null,emptyValue:""},e);var p=this;return this.each(function(){function h(){var a=f.position();b.css({left:a.left,top:a.top+f.outerHeight(),width:f.outerWidth()})}function l(a){return a.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function C(a){v.push(1);setTimeout(function(){v.pop();
v.length||a()},e.timeout)}function w(a,c){a=a.trim();if(a===x)c&&b.children().length&&b.show();else if(m.val(e.emptyValue),x=a,b.empty(),!a||a.length<e.minChars)b.hide();else if(p.trigger("beforeSearch",{val:a}),g.isArray(u))B(a,u);else{var d={};d[D]=a;g.get(u,d,function(n){B(a,n)})}}function B(a,c){var d="function"==typeof e.matchRegexp?e.matchRegexp(a,l):RegExp(l(a),"i"),n=RegExp("^"+l(a)+"$",d.flags),q=0;c.filter(function(y,z){var A=e.matchValue(y,z),E=r?e.itemValue(y,z):A;A.match(d)&&(0>=e.maxResults||
q<e.maxResults)&&(b.addResultItem(y,z),q++);A.match(n)&&m.val(E)});p.trigger("afterSearch",{});b.children().length?b.show():b.hide()}var k=!1,r="function"==typeof e.itemValue,f=g(this),x=f.val().trim(),D=f.attr("name"),m=g('<input type="hidden" value="'+e.emptyValue+'">'),b=g("<div>").addClass("autocompleter-result"),t=!1;f.after(b);window.addEventListener("resize",h);document.fonts.ready.then(h);h();r&&(m.attr("name",f.attr("name")),f.removeAttr("name").after(m));b.unselect=function(){b.find(".selected").removeClass("selected");
return this};b.show=function(){g.fn.show.apply(this,arguments);t=!0;b.unselect().scrollTop(0).children().first().addClass("selected");p.trigger("resultShow",{})};b.hide=function(){g.fn.hide.apply(this,arguments);t=!1;p.trigger("resultHide",{})};f.blur(function(){b.hide()});f.click(function(){w(f.val(),1)});f.on("paste",function(a){w(a.originalEvent.clipboardData.getData("text"),1)});b.mouseout(function(){k||b.unselect()});b.reselect=function(a){k=!1;b.unselect();g(a).addClass("selected")};b.addResultItem=
function(a,c){var d=e.matchValue(a,c),n=r?e.itemValue(a,c):d;d=g("<div>").addClass("autocompleter-item").attr("data-match-value",d).attr("data-value",n).html(e.itemDisplay(a,c)).mousedown(function(q){q.preventDefault()}).click(function(){b.selectVariant(g(this)).hide()}).mouseover(function(){k||b.reselect(this)}).mousemove(function(){k&&b.reselect(this)});b.append(d)};f.keyup(function(){C(function(){w(f.val())})});f.keydown(function(a){switch(a.which){case 38:a:if(t){k=!0;a=b.find(".selected").first();
if(a.length){b.unselect();var c=a.prev();if(c.length){a=c.addClass("selected").position().top;c=b.position().top-c.innerHeight();a<c&&b.scrollTop(b.scrollTop()+c+a);break a}}b.scrollTop(b.get(0).scrollHeight).children().last().addClass("selected")}break;case 40:a:if(t){k=!0;a=b.find(".selected").first();if(a.length){b.unselect();var d=a.next();if(d.length){a=b.outerHeight();c=d.addClass("selected").innerHeight();d=d.position().top+c;d>a&&b.scrollTop(b.scrollTop()+c-b.position().top-a+d);break a}}b.scrollTop(0).children().first().addClass("selected")}else b.children().length&&
b.show();break;case 13:a.preventDefault();a=b.find(".selected").first();a.length&&b.unselect().selectVariant(a);b.hide();break;case 9:b.hide();break;case 27:b.hide()}});b.selectVariant=function(a){var c=a.data("match-value");a=a.data("value");r&&m.val(a);f.val(c);x=c;b.empty();return this};var v=[]})}})(jQuery);