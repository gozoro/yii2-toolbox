(function(g){"undefined"==typeof g?console.warn("Required jQuery."):g.fn.autocompleter=function(u,f){f=g.extend({maxResults:0,minChars:1,timeout:500,matchRegexp:function(h,k){return RegExp(k(h),"i")},matchValue:function(h,k){return h},itemDisplay:function(h,k){return h},itemValue:null,emptyValue:""},f);var p=this;return this.each(function(){function h(){var a=e.position();b.css({left:a.left,top:a.top+e.outerHeight(),width:e.outerWidth()})}function k(a){return a.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}
function C(a){v.push(1);setTimeout(function(){v.pop();v.length||a()},f.timeout)}function w(a,c){a=a.trim();if(a===x)c&&b.children().length&&b.show();else if(m.val(f.emptyValue),x=a,b.empty(),!a||a.length<f.minChars)b.hide();else if(p.trigger("beforeSearch",{val:a}),g.isArray(u))B(a,u);else{var d={};d[D]=a;g.get(u,d,function(n){B(a,n)})}}function B(a,c){var d=f.matchRegexp(a,k),n=RegExp("^"+k(a)+"$",d.flags),q=0;c.filter(function(y,z){var A=f.matchValue(y,z),E=r?f.itemValue(y,z):A;A.match(d)&&(0>=
f.maxResults||q<f.maxResults)&&(b.addResultItem(y,z),q++);A.match(n)&&m.val(E)});p.trigger("afterSearch",{});b.children().length?b.show():b.hide()}var l=!1,r="function"==typeof f.itemValue,e=g(this),x=e.val().trim(),D=e.attr("name"),m=g('<input type="hidden" value="'+f.emptyValue+'">'),b=g("<div>").addClass("autocompleter-result"),t=!1;e.after(b);window.addEventListener("resize",h);document.fonts.ready.then(h);h();r&&(m.attr("name",e.attr("name")),e.removeAttr("name").after(m));b.unselect=function(){b.find(".selected").removeClass("selected");
return this};b.show=function(){g.fn.show.apply(this,arguments);t=!0;b.unselect().scrollTop(0).children().first().addClass("selected");p.trigger("resultShow",{})};b.hide=function(){g.fn.hide.apply(this,arguments);t=!1;p.trigger("resultHide",{})};e.blur(function(){b.hide()});e.click(function(){w(e.val(),1)});e.on("paste",function(a){w(a.originalEvent.clipboardData.getData("text"),1)});b.mouseout(function(){l||b.unselect()});b.reselect=function(a){l=!1;b.unselect();g(a).addClass("selected")};b.addResultItem=
function(a,c){var d=f.matchValue(a,c),n=r?f.itemValue(a,c):d;d=g("<div>").addClass("autocompleter-item").attr("data-match-value",d).attr("data-value",n).html(f.itemDisplay(a,c)).mousedown(function(q){q.preventDefault()}).click(function(){b.selectVariant(g(this)).hide()}).mouseover(function(){l||b.reselect(this)}).mousemove(function(){l&&b.reselect(this)});b.append(d)};e.keyup(function(){C(function(){w(e.val())})});e.keydown(function(a){switch(a.which){case 38:a:if(t){l=!0;a=b.find(".selected").first();
if(a.length){b.unselect();var c=a.prev();if(c.length){a=c.addClass("selected").position().top;c=b.position().top-c.innerHeight();a<c&&b.scrollTop(b.scrollTop()+c+a);break a}}b.scrollTop(b.get(0).scrollHeight).children().last().addClass("selected")}break;case 40:a:if(t){l=!0;a=b.find(".selected").first();if(a.length){b.unselect();var d=a.next();if(d.length){a=b.outerHeight();c=d.addClass("selected").innerHeight();d=d.position().top+c;d>a&&b.scrollTop(b.scrollTop()+c-b.position().top-a+d);break a}}b.scrollTop(0).children().first().addClass("selected")}else b.children().length&&
b.show();break;case 13:a.preventDefault();a=b.find(".selected").first();a.length&&b.unselect().selectVariant(a);b.hide();break;case 9:b.hide();break;case 27:b.hide()}});b.selectVariant=function(a){var c=a.data("match-value");a=a.data("value");r&&m.val(a);e.val(c);x=c;b.empty();return this};var v=[]})}})(jQuery);